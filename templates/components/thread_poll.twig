
<div id="poll">
  <div class="cat_bar">
    <h3 class="catbg">
      <span class="ie6_header floatleft">
        <img src="{{ settings['images_url'] }}/topic/{{ context['poll']['is_locked'] ? 'normal_poll_locked' : 'normal_poll' }}.gif" alt="" class="icon" /> {{ txt['poll'] }}
      </span>
    </h3>
  </div>

  <div class="windowbg">
    <span class="topslice"><span></span></span>
    <div class="content" id="poll_options">
      <h4 id="pollquestion">
        {{ context['poll']['question'] }}
      </h4>
      {% if context['poll']['show_results'] or not context['allow_vote'] %}
        <dl class="options">
          {# Show each option with its corresponding percentage bar. #}
          {% for option in context['poll']['options'] %}
            <dt class="middletext{{ option['voted_this'] ? ' voted' : '' }}">{{ option['option'] }}</dt>
            <dd class="middletext statsbar{{ option['voted_this'] ? ' voted' : '' }}">
              {% if context['allow_poll_view'] %}
                {{ option['bar_ndt'] }}
                <span class="percentage">{{ option['votes'] }} ({{ option['percent'] }}%)</span>
              {% endif %}
            </dd>
          {% endfor %}
        </dl>

        {% if context['allow_poll_view'] %}
          <p><strong>{{ txt['poll_total_voters'] }}:</strong> {{ context['poll']['total_votes'] }}</p>
        {% endif %}
      {% else %}
        <form action="{{ scripturl }}?action=vote;topic={{ context['current_topic'] }}.{{ context['start'] }};poll={{ context['poll']['id'] }}" method="post" accept-charset="{{ context['character_set'] }}">
          {# Show a warning if they are allowed more than one option. #}
          {% if context['poll']['allowed_warning'] %}
            <p class="smallpadding">{{ context['poll']['allowed_warning'] }}</p>
          {% endif %}

          <ul class="reset options">
            {# Show each option with its button - a radio likely. #}
            {% for option in context['poll']['options'] %}
              <li class="middletext">{{ option['vote_button'] }} <label for="{{ option['id'] }}">{{ option['option'] }}</label></li>
            {% endfor %}
          </ul>
          <div class="submitbutton">
            <input type="submit" value="{{ txt['poll_vote'] }}" />
            <input type="hidden" name="{{ context['session_var'] }}" value="{{ context['session_id'] }}" />
          </div>
        </form>
      {% endif %}
      {% if context['poll']['expire_time'] %}
        <p>
          <strong>{{ context['poll']['is_expired'] ? txt['poll_expired_on'] : txt['poll_expires_on'] }}:</strong> {{ context['poll']['expire_time'] }}
        </p>
      {% endif %}
      </div>
    </div>
  </div>

  <div id="pollmoderation">
    {% include 'components/topic_listing.twig' with {'buttons': poll_buttons} %}
  </div>
</div>
